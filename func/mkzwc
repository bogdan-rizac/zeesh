#!/usr/bin/env zsh

# pre-compiles zsh functions

mkzwc() {
    autoload -U zrecompile

    # compile functions found in $fpath
    for path in $fpath; do
        for func in `/bin/ls $path`; do
            local a=$path/$func
            zrecompile -p $a
            if [ -f $a.zwc.old ]; then
                rm -f $a.zwc.old
            fi
        done
    done

    # compile zsh files
    conf=(~/.zshrc ~/.zsh/zeesh.zsh ~/.zcompdump)
    for a in $conf; do
        zrecompile -p $a
        if [ -f $a.zwc.old ]; then
            rm -f $a.zwc.old
        fi
    done

    # compile plugins
    for plugin in ${plugins[*]}; do
        zrecompile -p ~/.zsh/plugins/$plugin/plugin.zsh
        if [ -f $a.zwc.old ]; then
            rm -f $a.zwc.old
        fi
    done
}
